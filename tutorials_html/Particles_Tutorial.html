

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials/Particles &mdash; amrex 18.01-dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials/SWFFT" href="SWFFT_Tutorial.html" />
    <link rel="prev" title="Tutorials/LinearSolvers" href="LinearSolvers_Tutorial.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> amrex
          

          
          </a>

          
            
            
              <div class="version">
                18.01-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="AMR_Tutorial.html">Tutorials/Amr</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basic_Tutorial.html">Tutorials/Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="CVODE_Tutorial.html">Tutorials/CVODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="EB_Tutorial.html">Tutorials/EB</a></li>
<li class="toctree-l1"><a class="reference internal" href="HYPRE_Tutorial.html">Tutorials/HYPRE</a></li>
<li class="toctree-l1"><a class="reference internal" href="LinearSolvers_Tutorial.html">Tutorials/LinearSolvers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials/Particles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#electrostaticpic"><strong>ElectrostaticPIC</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="#neighborlist"><strong>NeighborList</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SWFFT_Tutorial.html">Tutorials/SWFFT</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">amrex</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tutorials/Particles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Particles_Tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorials-particles">
<h1>Tutorials/Particles<a class="headerlink" href="#tutorials-particles" title="Permalink to this headline">¶</a></h1>
<p>There are two tutorials in amrex/Tutorials/Particles that demonstrate the basic usage of
AMReX’s particle data structures.</p>
<div class="section" id="electrostaticpic">
<h2><strong>ElectrostaticPIC</strong><a class="headerlink" href="#electrostaticpic" title="Permalink to this headline">¶</a></h2>
<p>This tutorial demonstrates how to perform an electrostatic Particle-in-Cell calculation
using AMReX. The code initializes a single particle in a conducting box (i.e. Dirichlet
zero boundary conditions) that is slightly off-center in one direction. Because of the
boundary conditions, the particle sees an image charge and is accelerated in this direction.</p>
<p>The code is currently set up to use one level of static mesh refinement. The charge density,
electric field, and electrostatic potential are all defined on the mesh nodes. To solve
Poisson’s equation, we use AMReX’s Fortran-based multigrid solver. The Fortran routines for
performing charge deposition, field gathering, and the particle push are all defined in
<code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">electrostatic_pic_2d</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">f90</span></span></code> and <code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">electrostatic_pic_3d</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">f90</span></span></code> for 2D and 3D, respectively.</p>
<p>The particle container in this example using a Struct-of-Arrays layout, with <code class="code cpp c++ docutils literal notranslate"><span class="literal number integer"><span class="pre">1</span></span> <span class="operator"><span class="pre">+</span></span> <span class="literal number integer"><span class="pre">2</span></span><span class="operator"><span class="pre">*</span></span><span class="name"><span class="pre">BL_SPACEDIM</span></span></code>
real components to store the particle weight, velocity, and the electric field interpolated
to the particle position. To see how to set up such a particle container, see
<code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">ElectrostaticParticleContainer</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">H</span></span></code>.</p>
</div>
<div class="section" id="neighborlist">
<h2><strong>NeighborList</strong><a class="headerlink" href="#neighborlist" title="Permalink to this headline">¶</a></h2>
<p>This tutorial demonstrates how to have AMReX’s particles undergo short-range collisions
with each other. To facilite this, a neighbor list data structure is created, in which
all of the partners that could potentially collide with a given particle are pre-computed.
This is done by first constructing a cell-linked list, and then looping over all 27 neighbor
cells to test for potential collision partners. The Fortran subroutine <code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">amrex_compute_forces_nl</span></span></code>
defined in <code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">neighbor_list_2d</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">f90</span></span></code> and <code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">neighbor_list_3d</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">f90</span></span></code> demonstrates how to loop over
the resulting data structure.</p>
<p>The particles in this example store velocity and acceleration in addition to the default
components. They are initially placed at cell centers and given random velocities. When a
particle reaches the domain boundary, it is specularly reflected back into the domain. To
see how the particle data structures are set up, see <code class="code cpp c++ docutils literal notranslate"><span class="name"><span class="pre">NeighborListParticleContainer</span></span><span class="punctuation"><span class="pre">.</span></span><span class="name"><span class="pre">cpp</span></span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SWFFT_Tutorial.html" class="btn btn-neutral float-right" title="Tutorials/SWFFT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="LinearSolvers_Tutorial.html" class="btn btn-neutral" title="Tutorials/LinearSolvers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2018, AMReX Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>