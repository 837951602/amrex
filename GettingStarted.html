

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Downloading the Code &mdash; amrex 10.17 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="amrex 10.17 documentation" href="index.html"/>
        <link rel="up" title="Getting Started" href="Chapter2.html"/>
        <link rel="next" title="Building AMReX" href="Chapter3.html"/>
        <link rel="prev" title="Getting Started" href="Chapter2.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> amrex
          

          
          </a>

          
            
            
              <div class="version">
                10.17
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">AMReX Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Chapter2.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Downloading the Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-hello-world">Example: Hello World</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-the-code">Building the Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-code">Running the Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parallelization">Parallelization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-heat-equation-solver">Example: Heat Equation Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running-the-code">Building and Running the Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Chapter3.html">Building AMReX</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter4.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Boundary.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="AmrCore.html">AmrCore Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Amr.html">Amr Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Particles.html">Particles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fortran.html">Fortran Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="EB.html">AmrCore Source Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="Profiling.html">Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="CVODE.html">CVODE</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">amrex</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Chapter2.html">Getting Started</a> &raquo;</li>
        
      <li>Downloading the Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/GettingStarted.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>In this chapter, we will walk you through two simple examples. It is
assumed here that your machine has GNU Make, Python, GCC (including
gfortran), and MPI, although &nbsp;can be built with CMake and other
compilers.</p>
<div class="section" id="downloading-the-code">
<h1>Downloading the Code<a class="headerlink" href="#downloading-the-code" title="Permalink to this headline">¶</a></h1>
<p>The source code of &nbsp;is available at
<a class="reference external" href="https://github.com/AMReX-Codes/amrex">https://github.com/AMReX-Codes/amrex</a>. The GitHub repo is our
central repo for development. The development branch
includes the latest state of the code, and it is merged into the master branch on a monthly basis. The master branch is
considered the release branch. The releases are tagged with version
number YY.MM (e.g., 17.04). The MM part of the
version is incremented every month, and the YY part every year.
Bug fix releases are tagged with YY.MM.patch (e.g., 17.04.1).</p>
</div>
<div class="section" id="example-hello-world">
<h1>Example: Hello World<a class="headerlink" href="#example-hello-world" title="Permalink to this headline">¶</a></h1>
<p>The source code of this example is at amrex/Tutorials/Basic/HelloWorld_C/ and is also shown below.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#include &lt;AMReX.H&gt;</span>
<span class="c1">#include &lt;AMReX_Print.H&gt;</span>

<span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">amrex</span><span class="p">::</span><span class="n">Initialize</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="n">argv</span><span class="p">);</span>
    <span class="n">amrex</span><span class="p">::</span><span class="n">Print</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;Hello world from AMReX version &quot;</span>
                   <span class="o">&lt;&lt;</span> <span class="n">amrex</span><span class="p">::</span><span class="n">Version</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="n">amrex</span><span class="p">::</span><span class="n">Finalize</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The main body of this short example contains three statements.
Usually the first and last statements for the main function of
every program should be calling amrex:: and
, respectively. The second statement calls amrex:: to print out a string that includes the
&nbsp;version returned by the amrex::
function. The example code includes two &nbsp;header files. Note
that the name of all &nbsp;header files starts with AMReX_
(or just AMReX in the case of AMReX.H). All &nbsp;functions are in the amrex namespace.</p>
<div class="section" id="building-the-code">
<h2>Building the Code<a class="headerlink" href="#building-the-code" title="Permalink to this headline">¶</a></h2>
<p>You build the code in the amrex/Tutorials/Basic/HelloWorld_C/
directory. Typing make will start the compilation process and
result in an executable named main3d.gnu.DEBUG.ex. The name
shows that the GNU compiler with debug options set by &nbsp;is used.
It also shows that the executable is built for 3D. Although this
simple example code is dimension independent, the dimension matters
for all non-trivial examples. The build process can be adjusted by
modifying the amrex/Tutorials/Basic/HelloWorld_C/GNUmakefile file.
More details on how to build &nbsp;can be found in
Chapter&nbsp;[Chap:BuildingAMReX].</p>
</div>
<div class="section" id="running-the-code">
<h2>Running the Code<a class="headerlink" href="#running-the-code" title="Permalink to this headline">¶</a></h2>
<p>The example code can be run as follows,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">main3d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">ex</span>
</pre></div>
</div>
<p>The result may look like,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Hello</span> <span class="n">world</span> <span class="kn">from</span> <span class="nn">AMReX</span> <span class="n">version</span> <span class="mf">17.05</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="n">g5775aed933c4</span><span class="o">-</span><span class="n">dirty</span>
</pre></div>
</div>
<p>The version string means the current commit 5775aed933c4 (note
that the first letter g in g577.. is not part of the hash)
is based on 17.05 with 30 additional commits and the work tree is dirty (i.e. there are uncommitted changes).</p>
<p>In the GNUmakefile there are compilation options for DEBUG
mode (less optimized code with more error checking), dimensionality,
compiler type, and flags to enable MPI and/or OpenMP parallelism.
If there are multiple instances of a parameter, the last instance
takes precedence.</p>
</div>
<div class="section" id="parallelization">
<h2>Parallelization<a class="headerlink" href="#parallelization" title="Permalink to this headline">¶</a></h2>
<p>Now let’s build with MPI by typing make USE_MPI=TRUE (alternatively
you can set USE_MPI=TRUE in the GNUmakefile). This
should make an executable named main3d.gnu.DEBUG.MPI.ex. Note
MPI in the file name. You can then run,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mpiexec</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="o">./</span><span class="n">main3d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">MPI</span><span class="o">.</span><span class="n">ex</span>
</pre></div>
</div>
<p>The result may look like,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MPI</span> <span class="n">initialized</span> <span class="k">with</span> <span class="mi">4</span> <span class="n">MPI</span> <span class="n">processes</span>
<span class="n">Hello</span> <span class="n">world</span> <span class="kn">from</span> <span class="nn">AMReX</span> <span class="n">version</span> <span class="mf">17.05</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="n">g5775aed933c4</span><span class="o">-</span><span class="n">dirty</span>
</pre></div>
</div>
<p>If the compilation fails, you are referred to
Chapter&nbsp;[Chap:BuildingAMReX] on how to configure the build
system.</p>
<p>If you want to build with OpenMP, type make USE_OMP=TRUE.
This should make an executable named main3d.gnu.DEBUG.OMP.ex. Note
OMP in the file name. Make sure the OMP_NUM_THREADS
environment variable is set on your system. You can then run,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">main3d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">OMP</span><span class="o">.</span><span class="n">ex</span>
</pre></div>
</div>
<p>The result may look like,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">OMP</span> <span class="n">initialized</span> <span class="k">with</span> <span class="mi">4</span> <span class="n">OMP</span> <span class="n">threads</span>
<span class="n">Hello</span> <span class="n">world</span> <span class="kn">from</span> <span class="nn">AMReX</span> <span class="n">version</span> <span class="mf">17.06</span><span class="o">-</span><span class="mi">287</span><span class="o">-</span><span class="n">g51875485fe51</span><span class="o">-</span><span class="n">dirty</span>
</pre></div>
</div>
<p>Note that you can build with both USE_MPI=TRUE and USE_OMP=TRUE.
You can then run,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mpiexec</span> <span class="o">-</span><span class="n">n</span> <span class="mi">2</span> <span class="o">./</span><span class="n">main3d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">MPI</span><span class="o">.</span><span class="n">OMP</span><span class="o">.</span><span class="n">ex</span>
</pre></div>
</div>
<p>The result may look like,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">MPI</span> <span class="n">initialized</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">MPI</span> <span class="n">processes</span>
<span class="n">OMP</span> <span class="n">initialized</span> <span class="k">with</span> <span class="mi">4</span> <span class="n">OMP</span> <span class="n">threads</span>
<span class="n">Hello</span> <span class="n">world</span> <span class="kn">from</span> <span class="nn">AMReX</span> <span class="n">version</span> <span class="mf">17.06</span><span class="o">-</span><span class="mi">287</span><span class="o">-</span><span class="n">g51875485fe51</span><span class="o">-</span><span class="n">dirty</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-heat-equation-solver">
<h1>Example: Heat Equation Solver<a class="headerlink" href="#example-heat-equation-solver" title="Permalink to this headline">¶</a></h1>
<p>We now look at a more complicated example at
amrex/Tutorials/Basic/HeatEquation_EX1_C and show how simulation
results can be visualized. This example solves the heat equation,</p>
<div class="math">
\[\frac{\partial\phi}{\partial t} = \nabla^2\phi\]</div>
<p>using forward Euler temporal integration on a periodic domain.
We could use a 5-point (in 2D) or 7-point (in 3D) stencil, but for demonstration
purposes we spatially discretize the PDE by first constructing fluxes on cell faces, e.g.,</p>
<div class="math">
\[F_{i+\myhalf,j} = \frac{\phi_{i+1,j}-\phi_{i,j}}{\Delta x},\]</div>
<p>and then taking the divergence to update the cells,</p>
<div class="math">
\[\phi_{i,j}^{n+1} = \phi_{i,j}^n
+ \frac{\Delta t}{\Delta x}\left(F_{i+\myhalf,j}-F_{i-\myhalf,j}\right)
+ \frac{\Delta t}{\Delta y}\left(F_{i,j+\myhalf}-F_{i,j-\myhalf}\right)\]</div>
<p>Don’t worry about the implementation details of the code.
You will be able to understand the code in this example after
Chapter&nbsp;[Chap:Basics].</p>
<div class="section" id="building-and-running-the-code">
<h2>Building and Running the Code<a class="headerlink" href="#building-and-running-the-code" title="Permalink to this headline">¶</a></h2>
<p>To build a 2D executable, type make DIM=2. This will generate
an executable named main2d.gnu.ex. To run it, type,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">main2d</span><span class="o">.</span><span class="n">gnu</span><span class="o">.</span><span class="n">DEBUG</span><span class="o">.</span><span class="n">ex</span> <span class="n">inputs_2d</span>
</pre></div>
</div>
<p>Note that the command takes a file inputs_2d. When the run
finishes, you will have a number of plotfiles, plt00000, plt01000, etc. The calculation solves the heat equation in 2D on a
<span class="math">\(256 \times 256\)</span> cells domain. It runs <span class="math">\(10,000\)</span> steps and makes a
plotfile every <span class="math">\(1,000\)</span> steps. These are runtime parameters that can
be adjusted in inputs_2d.</p>
</div>
</div>
<div class="section" id="visualization">
<h1>Visualization<a class="headerlink" href="#visualization" title="Permalink to this headline">¶</a></h1>
<p>There are several visualization tools that can be used for plotfiles. The standard tool used within the
-community is , a package developed and supported
by CCSE that is designed specifically for highly efficient visualization
of block-structured hierarchical AMR data.
Plotfiles can also be viewed using the , , and &nbsp;packages.
Particle data can be viewed using .
Refer to Chapter [Chap:Visualization] for how to use each of these tools.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Chapter3.html" class="btn btn-neutral float-right" title="Building AMReX" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Chapter2.html" class="btn btn-neutral" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, AMReX Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'10.17',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>